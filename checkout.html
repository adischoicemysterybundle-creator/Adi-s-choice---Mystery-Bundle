<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Checkout | Adi’s Choice</title>
<link rel="stylesheet" href="style.css" />
</head>
<body>
<header>
<img src="logo.jpeg" alt="Adi’s Choice Logo" class="logo" />
<h1>Checkout</h1>
</header>

<main>
<form id="checkoutForm" class="checkout-form">
<h2>Your Details</h2>
<input type="text" name="name" placeholder="Full Name" required />
<input type="email" name="email" placeholder="Email Address" required />

<h2>Your Bundle</h2>
<div id="bundleSummary"></div>

<h2>Delivery Method</h2>
<select name="delivery" required>
<option value="">Select delivery method</option>
<option value="DPD Courier">DPD Courier</option>
<option value="InPost">InPost</option>
<option value="DHL">DHL</option>
</select>

<h2>Payment Method</h2>
<select name="payment" required>
<option value="">Select payment method</option>
<option value="Bank Transfer">Bank Transfer</option>
</select>

<h2>Additional Info</h2>
<textarea name="additionalInfo" placeholder="Preferred colors, special requests..."></textarea>

<button type="submit" class="btn">Place Order</button>
</form>
</main>

<script>
// Populate summary from selection
const params = new URLSearchParams(window.location.search);
const classic = params.get('classic') || 'None';
const superPick = params.get('super') || 'None';
const premium = params.get('premium') || 'None';

const bundleSummary = `
<p><strong>Classic Picks:</strong> ${classic}</p>
<p><strong>Super Pick:</strong> ${superPick}</p>
<p><strong>Premium Pick:</strong> ${premium}</p>
`;
document.getElementById('bundleSummary').innerHTML = bundleSummary;

// Send form data via SendGrid API
document.getElementById('checkoutForm').addEventListener('submit', async (e) => {
e.preventDefault();
const formData = Object.fromEntries(new FormData(e.target).entries());

const response = await fetch('/api/sendEmail', {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({
name: formData.name,
email: formData.email,
bundleType: `${classic} | ${superPick} | ${premium}`,
bundleCount: 1,
price: "TBD",
additionalInfo: formData.additionalInfo,
}),
});

if (response.ok) {
window.location.href = 'thankyou.html';
} else {
alert('Something went wrong. Please try again.');
}
});
</script>
</body>
</html>
